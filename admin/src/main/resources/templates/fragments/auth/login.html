<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head th:replace="fragments/layout :: head(additionalCss='/css/auth/login.css')">
    <title>로그인</title>
</head>
<body class="login-page">
<!-- Header -->
<header th:replace="fragments/layout :: header"></header>

<!-- Main Content -->
<main>
    <section class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>담소 Admin</h1>
            </div>
            <form id="login-form"
                  hx-post="/api/auth/login"
                  hx-target="#error-message"
                  hx-swap="innerHTML"
                  hx-on::after-request="handleAdminLogin(event)">
                <div class="input-group">
                    <label for="email">이메일</label>
                    <input type="email" id="email" name="email" placeholder="이메일을 입력하세요" required>
                </div>
                <div class="input-group">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required>
                </div>
                <div class="button-group">
                    <button type="submit">로그인</button>
                </div>
            </form>
            <div id="error-message" class="error-message"></div>
        </div>
    </section>
</main>

<!-- Footer -->
<footer th:replace="fragments/layout :: footer"></footer>

<script>
    function handleAdminLogin(event) {
        const response = JSON.parse(event.detail.xhr.responseText);
        if (!event.detail.successful) {
            document.querySelector('#error-message').innerText = response.message || "로그인 실패";
            return;
        }

        if (response.status >= 200 && response.status < 300) {
            document.querySelector('#error-message').innerText = "";
            window.location.href = "/";
        }
    }
</script>
</body>
</html>
